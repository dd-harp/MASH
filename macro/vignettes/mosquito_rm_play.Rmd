---
title: "Playing with mosquito-rm"
output:
  html_notebook:
    df_print: paged
  pdf_document:
    toc: true
    df_print: kable
    number_sections: yes
header-includes:
  - \usepackage{palatino}
---
  patch_cnt <- 5
  params <- build_biting_parameters(patch_cnt)
  internal_params <- build_internal_parameters(params)
  infectious <- rep(0.4, patch_cnt)
  mortality <- 1 - params$p
  state <- build_biting_state(infectious, mortality, params$maxEIP)

  replacement <- (1 -params$p) / params$p
  aquatic <- function(lambda) rep(replacement, length(lambda))

  kappa <- 0.1
  kappa_patch = rep(kappa, patch_cnt)
  initial_state <- mrm_copy_state(state)
  for (i in 1:100) {
    state <- mosquito_rm_dynamics(state, internal_params, kappa_patch, aquatic)
  }

  k <- params$a * kappa * params$p / (1 - params$p)
  y0_expected <- with(params,
    rep(k / (1 - k), patch_cnt))
